<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIVOA LSc QMS - Event Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --font-size-base: 0.8125rem; --font-size-xs: 0.75rem; --font-size-sm: 0.8125rem;}
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; }
        body { font-family: 'Inter', sans-serif; font-size: var(--font-size-base); color: #334155; background-color: #f1f5f9; display: flex; flex-direction: column; }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; } ::-webkit-scrollbar-track { background: #e2e8f0; } ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 10px; } ::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        /* Layout */
        .main-layout { display: flex; flex-direction: column; height: 100vh; }
        header, .sub-navigation-container { flex-shrink: 0; }
        .content-area-wrapper { display: flex; flex-grow: 1; overflow: hidden; }
        main.content-view { flex-grow: 1; overflow-y: auto; padding: 1.5rem; }
        main.content-view.hidden { display: none; }
        
        /* Sub-navigation styles */
        .sub-nav { background-color: #f8fafc; border-bottom: 1px solid #e2e8f0; padding: 0.25rem 1rem; white-space: nowrap; overflow-x: auto; }
        .sub-nav-item { display: inline-flex; align-items: center; padding: 0.5rem 0.75rem; font-size: var(--font-size-xs); font-weight: 500; color: #475569; border-radius: 0.375rem; margin-right: 0.25rem; cursor: pointer; transition: all 0.15s ease-in-out; }
        .sub-nav-item:hover { color: #1e293b; background-color: #eef2ff; }
        .sub-nav-item.active { color: #4338ca; background-color: #e0e7ff; font-weight: 600; }
        .sub-nav-item .lucide { width: 1rem; height: 1rem; margin-right: 0.375rem; color: #9ca3af; }
        .sub-nav-item.active .lucide, .sub-nav-item:hover .lucide { color: #4f46e5; }
        
        /* Common View Styles */
        .view-header { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
        .view-title { font-size: 1.5rem; font-weight: 600; color: #1e293b; }
        .action-button { display: inline-flex; align-items: center; justify-content: center; padding: 0.5rem 1rem; border: 1px solid transparent; font-size: var(--font-size-xs); font-weight: 500; border-radius: 0.375rem; cursor: pointer; }
        .action-button.primary { color: white; background-color: #4f46e5; } .action-button.primary:hover:not(:disabled) { background-color: #4338ca; }
        .action-button.secondary { color: #334155; background-color: white; border-color: #cbd5e1; } .action-button.secondary:hover:not(:disabled) { background-color: #f8fafc; }
        .action-button:disabled { opacity: 0.5; cursor: not-allowed; }
        .action-button .lucide { width: 1rem; height: 1rem; margin-right: 0.5rem; }
        
        /* Content Card */
        .content-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; border: 1px solid #e2e8f0; }
        
        /* Data Table */
        .data-table-container { overflow-x: auto; }
        .data-table { width: 100%; min-width: 1000px; font-size: var(--font-size-xs); border-collapse: collapse; }
        .data-table th { text-align: left; padding: 0.75rem; background-color: #f8fafc; font-weight: 600; white-space: nowrap; }
        .data-table td { padding: 0.75rem; border-bottom: 1px solid #f1f5f9; white-space: nowrap; }
        .data-table .linkable { color: #4f46e5; font-weight: 500; cursor: pointer; }
        .data-table .wrap-text { white-space: normal; }
        .data-table .action-cell { text-align: right; }
        .data-table .action-cell button { color: #64748b; padding: 0.25rem; } .data-table .action-cell button:hover { color: #1e293b; }
        
        /* Status Badges */
        .status-badge { display: inline-flex; align-items: center; padding: 0.2rem 0.5rem; border-radius: 9999px; font-weight: 600; font-size: 0.7rem; text-transform: capitalize;}
        .status-badge.planned { background-color: #e0f2fe; color: #0369a1; }
        .status-badge.in_progress { background-color: #fef9c3; color: #854d0e; }
        .status-badge.closed { background-color: #dcfce7; color: #166534; }
        .status-badge.cancelled { background-color: #e5e7eb; color: #374151; }
        
        /* Filter Panel */
        .filter-panel { background-color: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; display: none; }
        .filter-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        .filter-grid label { font-size: var(--font-size-xs); font-weight: 500; margin-bottom: 0.25rem; }
        .filter-grid input, .filter-grid select { width: 100%; border-color: #d1d5db; border-radius: 0.375rem; box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); font-size: var(--font-size-xs); }
        
        /* AI Assistant Panel Styles */
        aside.ai-assistant-panel { width: 22rem; background-color: white; border-left: 1px solid #e2e8f0; display: flex; flex-direction: column; flex-shrink: 0; height: 100%; }
        .ai-assistant-header { padding: 0.75rem; border-bottom: 1px solid #e2e8f0; background-color: #4f46e5; color: white; }
        .ai-assistant-header h3 { font-size: var(--font-size-sm); font-weight: 600; }
        .ai-assistant-chat-area { flex-grow: 1; padding: 0.75rem; overflow-y: auto; font-size: var(--font-size-xs); }
        .ai-bubble { background-color: #f1f5f9; padding: 0.5rem 0.75rem; border-radius: 0.375rem; margin-bottom: 0.5rem; }
        .ai-bubble.suggestion { background-color: #eef2ff; border: 1px solid #e0e7ff; color: #3730a3; }
        .ai-bubble h4 { font-weight: 600; margin-bottom: 0.25rem; }
        .ai-assistant-input-area { padding: 0.75rem; border-top: 1px solid #e2e8f0; }
    </style>
</head>
<body class="main-layout">

    <header class="bg-white border-b border-slate-200 px-4 flex items-center justify-between flex-shrink-0 h-14">
        </header>

    <div class="sub-navigation-container">
         <nav class="sub-nav">
             <a href="#" class="sub-nav-item" data-target-view="dashboard-view"><i data-lucide="layout-dashboard"></i>Dashboard</a>
             <a href="#" class="sub-nav-item active" data-target-view="Events-view"><i data-lucide="clipboard-check"></i>Event Management</a>
             <a href="#" class="sub-nav-item" data-target-view="suppliers-view"><i data-lucide="truck"></i>Suppliers</a>
             </nav>
    </div>

    <div class="content-area-wrapper">
        <div id="view-container" class="flex-grow">
            <main id="Events-view" class="content-view">
                 <div class="view-header">
                    <h1 class="view-title">Event Management</h1>
                    <div class="view-actions">
                        <button id="toggle-Event-filters-button" class="action-button secondary"><i data-lucide="filter"></i>Filters</button>
                        <button class="action-button primary" id="schedule-new-Event-button"><i data-lucide="plus-circle"></i>Log New Event</button> 
                    </div>
                 </div>

                <div id="Event-filters-panel" class="filter-panel">
                    <h4 class="font-semibold mb-4">Filter Events</h4>
                    <form id="Event-filter-form">
                        <div class="filter-grid">
                            <div><label for="filter-event-id">Event ID</label><input type="text" id="filter-event-id"></div>
                            <div><label for="filter-event-type">Type</label><select id="filter-event-type"><option>All</option><option>Deviation</option><option>CAPA</option><option>Change Control</option></select></div>
                            <div><label for="filter-event-status">Status</label><select id="filter-event-status"><option>All</option><option>Planned</option><option>In Progress</option><option>Closed</option></select></div>
                            <div><label for="filter-initiator">Initiator</label><select id="filter-initiator"><option>All</option><option>A. Johnson</option><option>B. Williams</option><option>C. Brown</option></select></div>
                            <div><label for="filter-severity">Severity</label><select id="filter-severity"><option>All</option><option>High</option><option>Medium</option><option>Low</option></select></div>
                        </div>
                    </form>
                </div>
                 
                <div class="content-card">
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Event ID</th>
                                    <th class="wrap-text">Title</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Due Date</th>
                                    <th>Initiator</th>
                                    <th>Severity</th>
                                    <th class="action-cell">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="Events-table-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </main>
            <main id="Event-create-view" class="content-view hidden"></main>
        </div> 

        <aside class="ai-assistant-panel" id="ai-assistant-panel">
             <div class="ai-assistant-header">
                 <h3 class="font-semibold flex items-center"><i data-lucide="brain-circuit" class="w-5 h-5 mr-2"></i>AI Assistant</h3>
             </div>
             <div class="ai-assistant-chat-area" id="ai-chat-area">
                 <div class="ai-bubble suggestion">
                     <h4><i data-lucide="lightbulb"></i>Event Insights</h4>
                     <p>Ask me to 'find all supplier Events due next quarter', 'show overdue findings from internal Events', or 'generate a checklist for an ISO 13485 Event'.</p>
                 </div>
                 <div class="ai-bubble suggestion mt-2">
                     <h4 class="text-amber-700"><i data-lucide="alert-triangle"></i>Proactive Alert</h4>
                     <p>The annual internal Event for the Manufacturing department is overdue by 30 days. Recommend scheduling immediately.</p>
                 </div>
             </div>
             <div class="ai-assistant-input-area">
                 <div class="relative">
                     <input type="text" id="ai-input" placeholder="Ask AI to list Event..." class="w-full text-xs border rounded-full py-1.5 px-3">
                     <button title="Send" class="absolute inset-y-0 right-0 flex items-center pr-2 text-indigo-600"><i data-lucide="send" class="w-4 h-4"></i></button>
                 </div>
             </div>
        </aside>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') lucide.createIcons();
            
            // --- Mock Data ---
            const mockEventData = [
                { id: 'DEV-2025-001', title: 'Line 3 temperature out of range', type: 'Deviation', status: 'In Progress', dueDate: '2025-09-15', initiator: 'A. Johnson', severity: 'High' },
                { id: 'CAPA-2025-012', title: 'Update CMMS workflow for PM deferrals', type: 'CAPA', status: 'In Progress', dueDate: '2025-10-01', initiator: 'B. Williams', severity: 'Medium' },
                { id: 'CC-2025-034', title: 'Implement new QC testing protocol for Product X', type: 'Change Control', status: 'Planned', dueDate: '2025-09-20', initiator: 'C. Brown', severity: 'Medium' },
                { id: 'AUD-FIN-007', title: 'Finding from annual GMP audit', type: 'Audit Finding', status: 'Closed', dueDate: '2025-08-30', initiator: 'S. Gupta', severity: 'Low' }
            ];

            // --- UI Element References ---
            const allViews = document.querySelectorAll('.content-view');
            const subNavItems = document.querySelectorAll('.sub-nav-item');
            const EventsTableBody = document.getElementById('Events-table-body');
            const toggleFiltersButton = document.getElementById('toggle-Event-filters-button');
            const filtersPanel = document.getElementById('Event-filters-panel');
            const scheduleEventButton = document.getElementById('schedule-new-Event-button');

            // --- Data Rendering Function ---
            function renderEvents(data) {
                if (!EventsTableBody) return; 
                EventsTableBody.innerHTML = ''; 

                data.forEach(item => {
                    const row = `
                        <tr class="hover:bg-gray-50">
                            <td class="linkable font-medium">${item.id}</td>
                            <td class="wrap-text">${item.title}</td>
                            <td>${item.type}</td>
                            <td><span class="status-badge status-${item.status.toLowerCase().replace(/ /g, '_')}">${item.status}</span></td>
                            <td>${item.dueDate}</td>
                            <td class="linkable">${item.initiator}</td>
                            <td>${item.severity}</td>
                            <td class="action-cell">
                                <button title="View Details"><i data-lucide="eye" class="w-4 h-4"></i></button>
                            </td>
                        </tr>`;
                    
                    EventsTableBody.innerHTML += row;
                });

                if (typeof lucide !== 'undefined') lucide.createIcons();
            }
            
            // --- Event Listeners ---
            if (toggleFiltersButton && filtersPanel) {
                toggleFiltersButton.addEventListener('click', () => {
                    filtersPanel.style.display = filtersPanel.style.display === 'none' || filtersPanel.style.display === '' ? 'block' : 'none';
                });
            }

            if(scheduleEventButton) {
                scheduleEventButton.addEventListener('click', () => {
                     alert("Navigating to the Event creation wizard... (Placeholder for switching to Event-create-view)");
                });
            }

            function switchView(targetViewId) {
                allViews.forEach(view => view.classList.toggle('hidden', view.id !== targetViewId));
                subNavItems.forEach(item => {
                    item.classList.toggle('active', item.getAttribute('data-target-view') === targetViewId);
                });
                if (typeof lucide !== 'undefined') {
                    const view = document.getElementById(targetViewId);
                    if(view) lucide.createIcons({nodes: view.querySelectorAll('[data-lucide]')});
                }
            }
            
            subNavItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchView(item.getAttribute('data-target-view'));
                });
            });
            
            // --- Initial Load ---
            switchView('Events-view'); 
            renderEvents(mockEventData);
        });
    </script>
</body>
</html>